/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.4/samples
 */
plugins {
    id 'java'
}

version = '1.110'
archivesBaseName = "SkillAPI-Pro"

java.targetCompatibility(JavaVersion.VERSION_1_8)

repositories {
    mavenCentral()
    mavenLocal()
    maven {
        name = 'Spigot'
        url = 'https://hub.spigotmc.org/nexus/content/repositories/snapshots/'
    }
}

dependencies {
    var collections = files(
            'modules/BungeeCord.jar',
            'modules/craftbukkit-1.13.jar',
            'modules/LibsDisguises.jar',
            'modules/MCCore.jar',
            'modules/mockito-core-1.10.19.jar',
            'modules/MythicMobs-4.2.0.jar',
            'modules/NoCheatPlus.jar',
            'modules/objenesis-2.4.jar',
            'modules/Parties.jar',
            'modules/PlaceholderAPI-2.8.2.jar',
            'modules/ProtocolLib-3.3.1.jar',
            'modules/RPGInventory.jar',
            'modules/Vault.jar',
            'modules/WorldEdit.jar',
            'modules/WorldGuard.jar',
//            'modules/SecondSkillBar-1.2.6-12-a8.jar',
    )

    compileOnly collections
    testCompileOnly collections

    testCompileOnly 'junit:junit:4.12'

    runtimeOnly (
            'org.spigotmc:spigot:1.12.2-R0.1-SNAPSHOT',
//            'org.spigotmc:spigot-api:1.12.2-R0.1-SNAPSHOT',
    )
}

processResources {
    inputs.property 'version', project.version

    filesMatching('plugin.yml') {
        expand 'version': version
    }
}

jar {
//    archiveClassifier.set("trace")
    from 'modules/SkillAPIModule.jar'
    from 'modules/SkillAPIPlaceholders.jar'
}

tasks.register 'runServer', JavaExec, {

    workingDir = './run'

    classpath = files(sourceSets.main.runtimeClasspath).filter {
        it.name.endsWith '.jar'
    }

    doFirst {
        var f = file('./run')
        if (!f.exists())
            f.mkdir()
    }

    standardInput System.in
//    standardOutput System.out

//    commandLine 'cmd', '/c', 'java', '-cp', sourceSets.main.runtimeClasspath.join(';'), 'org.bukkit.craftbukkit.Main'
}